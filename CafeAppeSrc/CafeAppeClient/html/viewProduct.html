<!DOCTYPE html>
<html>
<head>
    <title>Admin Console</title>
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/color.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/demo/demo.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/jquery.easyui.min.js"></script>
    <script>src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"</script>

    <script>

        var toolbar = [{
            text:'Add',
            iconCls:'icon-add',
            handler:function(){
                $('#newWin').window('open');
            }
        }]

        $(document).ready(function(){
            $('#vp').datagrid({
                width:1000,
                height:250,
                remoteSort:false,
                singleSelect:true,
                nowrap:false,
                fitColumns:true,
                url:'/getProductList',
                columns:[[
                    {field:'productid',title:'Product Id',width:80},
                    {field:'productname',title:'Product Name',width:100,sortable:true},
                    {field:'productdescription',title:'Product Description',width:100,sortable:true},
                    {field:'productsize',title:'Product Size',width:100,sortable:true},
                    {field:'productprice',title:'Product Price',width:100,sortable:true}
                ]],
                detailFormatter: function(rowIndex, rowData){
                    return '<table><tr>' +
                        '<td rowspan=2 style="border:0" id = "ti">'+ rowData.productid +'</td>' +
                        '<td style="border:0">  + rowData.productname + </a> </td>'
                        + '<td>' + rowData.description +'</td>'
                        + '<td>' + rowData.size +'</td>'
                        + '<td>' + rowData.productPrice +'</td>'
                        + '<td> <input type="hidden" name="productSizeId" id="hiddenProductSizeId" value=' + rowData.productsizeid + '></td>'
                    '</tr></table>';
                },

                onDblClickRow: function(index,row) {
                    $('#pUpdateSubmit').hide();
                    $('#pUpdateReset').hide();
                    $('#pUpdateName').attr('readOnly', true);
                    $('#pUpdateDesc').attr('readOnly', true);
                    $('#pUpdatePrice').attr('readOnly', true);
                    $('#pUpdateSize').attr('readOnly', true);

                    $('#updateWin').window({
                        width:300,
                        height:200,
                        modal:true,
                        title:row.productname,
                        collapsible:false,
                        minimizable:false,
                        maximizable:false,
                        closed:false,
                        tools:[{
                            iconCls:'icon-edit',
                            handler:function(){
                                $('#pUpdateSubmit').show();
                                $('#pUpdateReset').show();
                                $('#pUpdateName').attr('readOnly', false);
                                $('#pUpdateDesc').attr('readOnly', false);
                                $('#pUpdatePrice').attr('readOnly', false);
                                $('#pUpdateSize').attr('readOnly', false);
                            }
                        },{
                            iconCls:'icon-remove',
                            handler:function(){
                                $.messager.confirm('Confirm','Are you sure you want to delete record?',function(r){
                                    if (r){
                                        window.location.href ='/getProductToArchive?id='+ document.getElementById('hiddenUpdateProductId').value
                                        + '&sizeid='+document.getElementById('hiddenUpdateProductSizeId').value;
                                    }
                                });
                            }
                        }]
                    });

                    $('#updateff').form('load',{
                        pUpdateName:row.productname,
                        pUpdateDesc:row.productdescription,
                        pUpdateSize:row.productsize,
                        pUpdatePrice:row.productprice,
                        productId: row.productid,
                        hiddenUpdateProductSizeId: row.productsizeid
                    });

                }


            });

        });
    </script>
</head>
<body>

<h1>List of Products</h1>
<table id="vp" data-options="toolbar:toolbar"></table>

<div id="updateWin" class="easyui-window" closed="true">
    <form id = "updateff" method="post" action ="/UpdateProductSubmit">
        <table>
            <tr>
                <td>Product Name</td>
                <td><input type= "text" id="pUpdateName" name="pUpdateName" placeholder="Enter product name"></td>
            </tr>
            <tr>
                <td>Product Description</td>
                <td><textarea  id="pUpdateDesc"  name="pUpdateDesc" placeholder="Product Description"></textarea></td>
            </tr>
            <tr>
                <td>Product Size</td>
                <td><input type= "text" id="pUpdateSize" name="pUpdateSize" placeholder="Enter product size"></td>
            </tr>
            <tr>
                <td>Product Price</td>
                <td><input type= "text" id="pUpdatePrice" name="pUpdatePrice" placeholder="Enter product Price"></td>
            </tr>
            <tr>
                <td><input type="submit" id="pUpdateSubmit" name="pUpdateSubmit" name="Update" ></td>
                <td><input type="reset" id="pUpdateReset" name="pUpdateReset" name="Reset"></td>
            </tr>
        </table>
        <input type="hidden" name="productId" id="hiddenUpdateProductId">
        <input type="hidden" name="hiddenUpdateProductSizeId" id="hiddenUpdateProductSizeId">
    </form>
</div>

<div id="newWin" class="easyui-window" title="Login" style="width:300px;height:180px;" closed="true">
    <form id = "newff" method="post" action ="/addProductSubmit">
        <table>
            <tr>
                <td>Product Name</td>
                <td><input type= "text" id="pNewName" name="pNewName" placeholder="Enter product name" ></td>
            </tr>
            <tr>
                <td>Product Description</td>
                <td><textarea  id="pNewDesc"  name="pNewDesc" placeholder="Product Description" ></textarea></td>
            </tr>
            <tr>
                <td>Product Size</td>
                <td><input type= "text" id="pNewSize" name="pNewSize" placeholder="Enter product size" ></td>
            </tr>
            <tr>
                <td>Product Price</td>
                <td><input type= "text" id="pNewPrice" name="pNewPrice" placeholder="Enter product Price" ></td>
            </tr>
            <tr>
                <td><input type="submit" id="pNewSubmit" name="pNewSubmit" name="Submit" ></td>
                <td><input type="reset" id="pNewReset" name="pNewSubmit" name="Reset"></td>
            </tr>
        </table>
    </form>
</div>


<p><a href = "/addProduct">Add new Product</a></p>
<p><a href = "/archivedCafe">View Archived Cafes...</a></p>
<p><a href = "/Menu">View Menu</a></p>
</body>
</html>
